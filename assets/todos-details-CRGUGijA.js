import{t as w,v as y,a as n,o as e,N as T,w as E}from"./chunk-NL6KNZEE-p7aHl_Kw.js";import{a as M}from"./TodosContext-BJnA4pI1.js";function S(){const m=w(),f=Number(m.todoId),p=y(),{todos:i,getSessionTodos:R,setSessionTodos:h,deleteSessionTodos:D,updateTodos:x}=n.useContext(M),[r,j]=n.useState({}),[c,g]=n.useState(!0),[a,N]=n.useState(!1),d=n.useRef(null),l=n.useRef(null);f||p("/todos");const b=()=>{N(t=>!t)},v=(t,s)=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette tâche ?")){const o=s.filter(u=>Number(u.id)!==Number(t.id));h(o),x(o)}p("/todos")},C=(t,s)=>{const o=s.map(u=>Number(u.id)===Number(t.id)?t:u);h(o),x(o),console.log("modify")},k=()=>{const t=(d.current&&d.current.innerText)??"",s=(l.current&&l.current.innerText)??"";if(console.log(t,s),t.length>0&&s.length>0){const o={...r,title:t,description:s};C(o,i)}N(!1)};return n.useEffect(()=>{(async()=>{if(c&&i){const t=await i.find(s=>Number(s.id)===f);j(t),t&&g(!1)}})()},[c,i,d,l]),r?e.jsxs("article",{className:"main-articles",children:[e.jsx("h2",{className:"main-articles-title",contentEditable:a,suppressContentEditableWarning:!0,ref:d,children:r.title}),e.jsx("p",{contentEditable:a,suppressContentEditableWarning:!0,ref:l,children:r.description}),e.jsxs("aside",{className:"cta-links-container",children:[e.jsx("button",{onClick:()=>v(r,i),className:"cta-links cta-links-secondary",children:"Supprimer"}),e.jsx("button",{className:"cta-links",onClick:()=>a?k():b(),children:a?"Valider":"Modifier"})]})]}):e.jsxs("article",{className:"main-articles",children:[e.jsx("h2",{className:"main-articles-title",children:c?"Chargement":"Erreur"}),c&&e.jsx("p",{children:"Les données sont en cours de récupération..."}),!c&&e.jsxs("p",{children:["Aucun contenu ne correspond à votre recherche. ",e.jsx(T,{to:"/todos",children:"Revenir sur la liste des tâches"})]})]})}function I({}){return[{title:"Todo Detail"},{name:"description",content:"A simple detailled todo object in React"}]}const P=E(function(){return e.jsxs("section",{className:"main-sections",children:[e.jsx(T,{to:"/todos",className:"cta-links",children:"Retour"}),e.jsx(S,{})]})});export{P as default,I as meta};
